<h1>Precognition</h1>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#live-validation">Live Validation</a><ul>
<li><a href="#using-vue">Using Vue</a></li>
<li><a href="#using-vue-and-inertia">Using Vue &amp; Inertia</a></li>
<li><a href="#using-react">Using React</a></li>
<li><a href="#using-react-and-inertia">Using React &amp; Inertia</a></li>
<li><a href="#using-alpine">Using Alpine &amp; Blade</a></li>
<li><a href="#configuring-axios">Configuring Axios</a></li>
</ul>
</li>
<li><a href="#customizing-validation-rules">Customizing Validation Rules</a></li>
<li><a href="#handling-file-uploads">Handling File Uploads</a></li>
<li><a href="#managing-side-effects">Managing Side-Effects</a></li>
<li><a href="#testing">Testing</a></li>
</ul>
<p><a name="introduction"></a></p>
<h2>Introduction</h2>
<p>Laravel Precognition allows you to anticipate the outcome of a future HTTP request. One of the primary use cases of Precognition is the ability to provide &quot;live&quot; validation for your frontend JavaScript application without having to duplicate your application&#39;s backend validation rules. Precognition pairs especially well with Laravel&#39;s Inertia-based <a href="/docs/%7B%7Bversion%7D%7D/starter-kits">starter kits</a>.</p>
<p>When Laravel receives a &quot;precognitive request&quot;, it will execute all of the route&#39;s middleware and resolve the route&#39;s controller dependencies, including validating <a href="/docs/%7B%7Bversion%7D%7D/validation#form-request-validation">form requests</a> - but it will not actually execute the route&#39;s controller method.</p>
<p><a name="live-validation"></a></p>
<h2>Live Validation</h2>
<p><a name="using-vue"></a></p>
<h3>Using Vue</h3>
<p>Using Laravel Precognition, you can offer live validation experiences to your users without having to duplicate your validation rules in your frontend Vue application. To illustrate how it works, let&#39;s build a form for creating new users within our application.</p>
<p>First, to enable Precognition for a route, the <code>HandlePrecognitiveRequests</code> middleware should be added to the route definition. You should also create a <a href="/docs/%7B%7Bversion%7D%7D/validation#form-request-validation">form request</a> to house the route&#39;s validation rules:</p>
<pre><code class="hljs language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Requests</span>\<span class="hljs-title">StoreUserRequest</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Foundation</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Middleware</span>\<span class="hljs-title">HandlePrecognitiveRequests</span>;

<span class="hljs-title class_">Route</span>::<span class="hljs-title function_ invoke__">post</span>(<span class="hljs-string">&#x27;/users&#x27;</span>, function (StoreUserRequest <span class="hljs-variable">$request</span>) {
    <span class="hljs-comment">// ...</span>
})-&gt;<span class="hljs-title function_ invoke__">middleware</span>([<span class="hljs-title class_">HandlePrecognitiveRequests</span>::<span class="hljs-variable language_">class</span>]);
</code></pre><p>Next, you should install the Laravel Precognition frontend helpers for Vue via NPM:</p>
<pre><code class="hljs language-shell">npm install laravel-precognition-vue
</code></pre><p>With the Laravel Precognition package installed, you can now create a form object using Precognition&#39;s <code>useForm</code> function, providing the HTTP method (<code>post</code>), the target URL (<code>/users</code>), and the initial form data.</p>
<p>Then, to enable live validation, invoke the form&#39;s <code>validate</code> method on each input&#39;s <code>change</code> event, providing the input&#39;s name:</p>
<pre><code class="hljs language-vue">&lt;script setup&gt;
import { useForm } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;laravel-precognition-vue&#x27;</span>;

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">form</span> = <span class="hljs-title function_ invoke__">useForm</span>(<span class="hljs-string">&#x27;post&#x27;</span>, <span class="hljs-string">&#x27;/users&#x27;</span>, {
    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;&#x27;</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">&#x27;&#x27;</span>,
});

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">submit</span> = () =&gt; form.<span class="hljs-title function_ invoke__">submit</span>();
&lt;/script&gt;

&lt;template&gt;
    &lt;form @submit.prevent=<span class="hljs-string">&quot;submit&quot;</span>&gt;
        &lt;label <span class="hljs-keyword">for</span>=<span class="hljs-string">&quot;name&quot;</span>&gt;Name&lt;/label&gt;
        &lt;input
            id=<span class="hljs-string">&quot;name&quot;</span>
            v-model=<span class="hljs-string">&quot;form.name&quot;</span>
            @change=<span class="hljs-string">&quot;form.validate(&#x27;name&#x27;)&quot;</span>
        /&gt;
        &lt;div v-<span class="hljs-keyword">if</span>=<span class="hljs-string">&quot;form.invalid(&#x27;name&#x27;)&quot;</span>&gt;
            {{ form.errors.name }}
        &lt;/div&gt;

        &lt;label <span class="hljs-keyword">for</span>=<span class="hljs-string">&quot;email&quot;</span>&gt;Email&lt;/label&gt;
        &lt;input
            id=<span class="hljs-string">&quot;email&quot;</span>
            type=<span class="hljs-string">&quot;email&quot;</span>
            v-model=<span class="hljs-string">&quot;form.email&quot;</span>
            @change=<span class="hljs-string">&quot;form.validate(&#x27;email&#x27;)&quot;</span>
        /&gt;
        &lt;div v-<span class="hljs-keyword">if</span>=<span class="hljs-string">&quot;form.invalid(&#x27;email&#x27;)&quot;</span>&gt;
            {{ form.errors.email }}
        &lt;/div&gt;

        &lt;button :disabled=<span class="hljs-string">&quot;form.processing&quot;</span>&gt;
            Create User
        &lt;/button&gt;
    &lt;/form&gt;
&lt;/template&gt;
</code></pre><p>Now, as the form is filled by the user, Precognition will provide live validation output powered by the validation rules in the route&#39;s form request. When the form&#39;s inputs are changed, a debounced &quot;precognitive&quot; validation request will be sent to your Laravel application. You may configure the debounce timeout by calling the form&#39;s <code>setValidationTimeout</code> function:</p>
<pre><code class="hljs language-js">form.<span class="hljs-title function_">setValidationTimeout</span>(<span class="hljs-number">3000</span>);
</code></pre><p>When a validation request is in-flight, the form&#39;s <code>validating</code> property will be <code>true</code>:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;form.validating&quot;</span>&gt;</span>
    Validating...
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre><p>Any validation errors returned during a validation request or a form submission will automatically populate the form&#39;s <code>errors</code> object:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;form.invalid(&#x27;email&#x27;)&quot;</span>&gt;</span>
    {{ form.errors.email }}
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre><p>You can determine if the form has any errors using the form&#39;s <code>hasErrors</code> property:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;form.hasErrors&quot;</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- ... --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre><p>You may also determine if an input has passed or failed validation by passing the input&#39;s name to the form&#39;s <code>valid</code> and <code>invalid</code> functions, respectively:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;form.valid(&#x27;email&#x27;)&quot;</span>&gt;</span>
    ✅
<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-else-if</span>=<span class="hljs-string">&quot;form.invalid(&#x27;email&#x27;)&quot;</span>&gt;</span>
    ❌
<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
</code></pre><blockquote>
<p><strong>Warning</strong>
A form input will only appear as valid or invalid once it has changed and a validation response has been received.</p>
</blockquote>
<p>If you are validating a subset of a form&#39;s inputs with Precognition, it can be useful to manually clear errors. You may use the form&#39;s <code>forgetError</code> function to achieve this:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span>
    <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;avatar&quot;</span>
    <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span>
    @<span class="hljs-attr">change</span>=<span class="hljs-string">&quot;(e) =&gt; {
        form.avatar = e.target.files[0]

        form.forgetError(&#x27;avatar&#x27;)
    }&quot;</span>
&gt;</span>
</code></pre><p>Of course, you may also execute code in reaction to the response to the form submission. The form&#39;s <code>submit</code> function returns an Axios request promise. This provides a convenient way to access the response payload, reset the form inputs on successful submission, or handle a failed request:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">submit</span> = (<span class="hljs-params"></span>) =&gt; form.<span class="hljs-title function_">submit</span>()
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
        form.<span class="hljs-title function_">reset</span>();

        <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;User created.&#x27;</span>);
    })
    .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
        <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;An error occurred.&#x27;</span>);
    });
</code></pre><p>You may determine if a form submission request is in-flight by inspecting the form&#39;s <code>processing</code> property:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">:disabled</span>=<span class="hljs-string">&quot;form.processing&quot;</span>&gt;</span>
    Submit
<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
</code></pre><p><a name="using-vue-and-inertia"></a></p>
<h3>Using Vue &amp; Inertia</h3>
<blockquote>
<p><strong>Note</strong>
If you would like a head start when developing your Laravel application with Vue and Inertia, consider using one of our <a href="/docs/%7B%7Bversion%7D%7D/starter-kits">starter kits</a>. Laravel&#39;s starter kits provide backend and frontend authentication scaffolding for your new Laravel application.</p>
</blockquote>
<p>Before using Precognition with Vue and Inertia, be sure to review our general documentation on <a href="#using-vue">using Precognition with Vue</a>. When using Vue with Inertia, you will need to install the Inertia compatible Precognition library via NPM:</p>
<pre><code class="hljs language-shell">npm install laravel-precognition-vue-inertia
</code></pre><p>Once installed, Precognition&#39;s <code>useForm</code> function will return an Inertia <a href="https://inertiajs.com/forms#form-helper">form helper</a> augmented with the validation features discussed above.</p>
<p>The form helper&#39;s <code>submit</code> method has been streamlined, removing the need to specify the HTTP method or URL. Instead, you may pass Inertia&#39;s <a href="https://inertiajs.com/manual-visits">visit options</a> as the first and only argument. In addition, the <code>submit</code> method does not return a Promise as seen in the Vue example above. Instead, you may provide any of Inertia&#39;s supported <a href="https://inertiajs.com/manual-visits#event-callbacks">event callbacks</a> in the visit options given to the <code>submit</code> method:</p>
<pre><code class="hljs language-vue">&lt;script setup&gt;
import { useForm } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;laravel-precognition-vue-inertia&#x27;</span>;

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">form</span> = <span class="hljs-title function_ invoke__">useForm</span>(<span class="hljs-string">&#x27;post&#x27;</span>, <span class="hljs-string">&#x27;/users&#x27;</span>, {
    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;&#x27;</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">&#x27;&#x27;</span>,
});

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">submit</span> = () =&gt; form.<span class="hljs-title function_ invoke__">submit</span>({
    <span class="hljs-attr">preserveScroll</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">onSuccess</span>: () =&gt; form.<span class="hljs-title function_ invoke__">reset</span>(),
});
&lt;/script&gt;
</code></pre><p><a name="using-react"></a></p>
<h3>Using React</h3>
<p>Using Laravel Precognition, you can offer live validation experiences to your users without having to duplicate your validation rules in your frontend React application. To illustrate how it works, let&#39;s build a form for creating new users within our application.</p>
<p>First, to enable Precognition for a route, the <code>HandlePrecognitiveRequests</code> middleware should be added to the route definition. You should also create a <a href="/docs/%7B%7Bversion%7D%7D/validation#form-request-validation">form request</a> to house the route&#39;s validation rules:</p>
<pre><code class="hljs language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Requests</span>\<span class="hljs-title">StoreUserRequest</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Foundation</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Middleware</span>\<span class="hljs-title">HandlePrecognitiveRequests</span>;

<span class="hljs-title class_">Route</span>::<span class="hljs-title function_ invoke__">post</span>(<span class="hljs-string">&#x27;/users&#x27;</span>, function (StoreUserRequest <span class="hljs-variable">$request</span>) {
    <span class="hljs-comment">// ...</span>
})-&gt;<span class="hljs-title function_ invoke__">middleware</span>([<span class="hljs-title class_">HandlePrecognitiveRequests</span>::<span class="hljs-variable language_">class</span>]);
</code></pre><p>Next, you should install the Laravel Precognition frontend helpers for React via NPM:</p>
<pre><code class="hljs language-shell">npm install laravel-precognition-react
</code></pre><p>With the Laravel Precognition package installed, you can now create a form object using Precognition&#39;s <code>useForm</code> function, providing the HTTP method (<code>post</code>), the target URL (<code>/users</code>), and the initial form data.</p>
<p>To enable live validation, you should listen to each input&#39;s <code>change</code> and <code>blur</code> event. In the <code>change</code> event handler, you should set the form&#39;s data with the <code>setData</code> function, passing the input&#39;s name and new value. Then, in the <code>blur</code> event handler invoke the form&#39;s <code>validate</code> method, providing the input&#39;s name:</p>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">import</span> { useForm } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;laravel-precognition-react&#x27;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Form</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">const</span> form = <span class="hljs-title function_">useForm</span>(<span class="hljs-string">&#x27;post&#x27;</span>, <span class="hljs-string">&#x27;/users&#x27;</span>, {
        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;&#x27;</span>,
        <span class="hljs-attr">email</span>: <span class="hljs-string">&#x27;&#x27;</span>,
    });

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">submit</span> = (<span class="hljs-params">e</span>) =&gt; {
        e.<span class="hljs-title function_">preventDefault</span>();

        form.<span class="hljs-title function_">submit</span>();
    };

    <span class="hljs-keyword">return</span> (
        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{submit}</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;name&quot;</span>&gt;</span>Name<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
                <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;name&quot;</span>
                <span class="hljs-attr">value</span>=<span class="hljs-string">{form.data.name}</span>
                <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> form.setData(&#x27;name&#x27;, e.target.value)}
                onBlur={() =&gt; form.validate(&#x27;name&#x27;)}
            /&gt;
            {form.invalid(&#x27;name&#x27;) &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{form.errors.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}

            <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;email&quot;</span>&gt;</span>Email<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
                <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;email&quot;</span>
                <span class="hljs-attr">value</span>=<span class="hljs-string">{form.data.email}</span>
                <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> form.setData(&#x27;email&#x27;, e.target.value)}
                onBlur={() =&gt; form.validate(&#x27;email&#x27;)}
            /&gt;
            {form.invalid(&#x27;email&#x27;) &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{form.errors.email}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}

            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{form.processing}</span>&gt;</span>
                Create User
            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
    );
};
</code></pre><p>Now, as the form is filled by the user, Precognition will provide live validation output powered by the validation rules in the route&#39;s form request. When the form&#39;s inputs are changed, a debounced &quot;precognitive&quot; validation request will be sent to your Laravel application. You may configure the debounce timeout by calling the form&#39;s <code>setValidationTimeout</code> function:</p>
<pre><code class="hljs language-js">form.<span class="hljs-title function_">setValidationTimeout</span>(<span class="hljs-number">3000</span>);
</code></pre><p>When a validation request is in-flight, the form&#39;s <code>validating</code> property will be <code>true</code>:</p>
<pre><code class="hljs language-jsx">{form.<span class="hljs-property">validating</span> &amp;&amp; <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Validating...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>}
</code></pre><p>Any validation errors returned during a validation request or a form submission will automatically populate the form&#39;s <code>errors</code> object:</p>
<pre><code class="hljs language-jsx">{form.<span class="hljs-title function_">invalid</span>(<span class="hljs-string">&#x27;email&#x27;</span>) &amp;&amp; <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{form.errors.email}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>}
</code></pre><p>You can determine if the form has any errors using the form&#39;s <code>hasErrors</code> property:</p>
<pre><code class="hljs language-jsx">{form.<span class="hljs-property">hasErrors</span> &amp;&amp; <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-comment">&lt;!-- ... --&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>}
</code></pre><p>You may also determine if an input has passed or failed validation by passing the input&#39;s name to the form&#39;s <code>valid</code> and <code>invalid</code> functions, respectively:</p>
<pre><code class="hljs language-jsx">{form.<span class="hljs-title function_">valid</span>(<span class="hljs-string">&#x27;email&#x27;</span>) &amp;&amp; <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>✅<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>}

{form.<span class="hljs-title function_">invalid</span>(<span class="hljs-string">&#x27;email&#x27;</span>) &amp;&amp; <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>❌<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>}
</code></pre><blockquote>
<p><strong>Warning</strong>
A form input will only appear as valid or invalid once it has changed and a validation response has been received.</p>
</blockquote>
<p>If you are validating a subset of a form&#39;s inputs with Precognition, it can be useful to manually clear errors. You may use the form&#39;s <code>forgetError</code> function to achieve this:</p>
<pre><code class="hljs language-jsx">&lt;input
    id=<span class="hljs-string">&quot;avatar&quot;</span>
    type=<span class="hljs-string">&quot;file&quot;</span>
    onChange={<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> 
        form.<span class="hljs-title function_">setData</span>(<span class="hljs-string">&#x27;avatar&#x27;</span>, e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>);

        form.<span class="hljs-title function_">forgetError</span>(<span class="hljs-string">&#x27;avatar&#x27;</span>);
    }
&gt;
</code></pre><p>Of course, you may also execute code in reaction to the response to the form submission. The form&#39;s <code>submit</code> function returns an Axios request promise. This provides a convenient way to access the response payload, reset the form&#39;s inputs on a successful form submission, or handle a failed request:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">submit</span> = (<span class="hljs-params">e</span>) =&gt; {
    e.<span class="hljs-title function_">preventDefault</span>();

    form.<span class="hljs-title function_">submit</span>()
        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
            form.<span class="hljs-title function_">reset</span>();

            <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;User created.&#x27;</span>);
        })
        .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
            <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;An error occurred.&#x27;</span>);
        });
};
</code></pre><p>You may determine if a form submission request is in-flight by inspecting the form&#39;s <code>processing</code> property:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{form.processing}</span>&gt;</span>
    Submit
<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
</code></pre><p><a name="using-react-and-inertia"></a></p>
<h3>Using React &amp; Inertia</h3>
<blockquote>
<p><strong>Note</strong>
If you would like a head start when developing your Laravel application with React and Inertia, consider using one of our <a href="/docs/%7B%7Bversion%7D%7D/starter-kits">starter kits</a>. Laravel&#39;s starter kits provide backend and frontend authentication scaffolding for your new Laravel application.</p>
</blockquote>
<p>Before using Precognition with React and Inertia, be sure to review our general documentation on <a href="#using-react">using Precognition with React</a>. When using React with Inertia, you will need to install the Inertia compatible Precognition library via NPM:</p>
<pre><code class="hljs language-shell">npm install laravel-precognition-react-inertia
</code></pre><p>Once installed, Precognition&#39;s <code>useForm</code> function will return an Inertia <a href="https://inertiajs.com/forms#form-helper">form helper</a> augmented with the validation features discussed above.</p>
<p>The form helper&#39;s <code>submit</code> method has been streamlined, removing the need to specify the HTTP method or URL. Instead, you may pass Inertia&#39;s <a href="https://inertiajs.com/manual-visits">visit options</a> as the first and only argument. In addition, the <code>submit</code> method does not return a Promise as seen in the React example above. Instead, you may provide any of Inertia&#39;s supported <a href="https://inertiajs.com/manual-visits#event-callbacks">event callbacks</a> in the visit options given to the <code>submit</code> method:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> { useForm } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;laravel-precognition-react-inertia&#x27;</span>;

<span class="hljs-keyword">const</span> form = <span class="hljs-title function_">useForm</span>(<span class="hljs-string">&#x27;post&#x27;</span>, <span class="hljs-string">&#x27;/users&#x27;</span>, {
    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;&#x27;</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">&#x27;&#x27;</span>,
});

<span class="hljs-keyword">const</span> <span class="hljs-title function_">submit</span> = (<span class="hljs-params">e</span>) =&gt; {
    e.<span class="hljs-title function_">preventDefault</span>();

    form.<span class="hljs-title function_">submit</span>({
        <span class="hljs-attr">preserveScroll</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">onSuccess</span>: <span class="hljs-function">() =&gt;</span> form.<span class="hljs-title function_">reset</span>(),
    });
};
</code></pre><p><a name="using-alpine"></a></p>
<h3>Using Alpine &amp; Blade</h3>
<p>Using Laravel Precognition, you can offer live validation experiences to your users without having to duplicate your validation rules in your frontend Alpine application. To illustrate how it works, let&#39;s build a form for creating new users within our application.</p>
<p>First, to enable Precognition for a route, the <code>HandlePrecognitiveRequests</code> middleware should be added to the route definition. You should also create a <a href="/docs/%7B%7Bversion%7D%7D/validation#form-request-validation">form request</a> to house the route&#39;s validation rules:</p>
<pre><code class="hljs language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Requests</span>\<span class="hljs-title">CreateUserRequest</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Foundation</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Middleware</span>\<span class="hljs-title">HandlePrecognitiveRequests</span>;

<span class="hljs-title class_">Route</span>::<span class="hljs-title function_ invoke__">post</span>(<span class="hljs-string">&#x27;/users&#x27;</span>, function (CreateUserRequest <span class="hljs-variable">$request</span>) {
    <span class="hljs-comment">// ...</span>
})-&gt;<span class="hljs-title function_ invoke__">middleware</span>([<span class="hljs-title class_">HandlePrecognitiveRequests</span>::<span class="hljs-variable language_">class</span>]);
</code></pre><p>Next, you should install the Laravel Precognition frontend helpers for Alpine via NPM:</p>
<pre><code class="hljs language-shell">npm install laravel-precognition-alpine
</code></pre><p>Then, register the Precognition plugin with Alpine in your <code>resources/js/app.js</code> file:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Alpine</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;alpinejs&#x27;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Precognition</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;laravel-precognition-alpine&#x27;</span>;

<span class="hljs-variable language_">window</span>.<span class="hljs-property">Alpine</span> = <span class="hljs-title class_">Alpine</span>;

<span class="hljs-title class_">Alpine</span>.<span class="hljs-title function_">plugin</span>(<span class="hljs-title class_">Precognition</span>);
<span class="hljs-title class_">Alpine</span>.<span class="hljs-title function_">start</span>();
</code></pre><p>With the Laravel Precognition package installed and registered, you can now create a form object using Precognition&#39;s <code>$form</code> &quot;magic&quot;, providing the HTTP method (<code>post</code>), the target URL (<code>/users</code>), and the initial form data.</p>
<p>To enable live validation, you should bind the form&#39;s data to its relevant input and then listen to each input&#39;s <code>change</code> event. In the <code>change</code> event handler, you should invoke the form&#39;s <code>validate</code> method, providing the input&#39;s name:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">x-data</span>=<span class="hljs-string">&quot;{
    form: $form(&#x27;post&#x27;, &#x27;/register&#x27;, {
        name: &#x27;&#x27;,
        email: &#x27;&#x27;,
    }),
}&quot;</span>&gt;</span>
    @csrf
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;name&quot;</span>&gt;</span>Name<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;name&quot;</span>
        <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span>
        <span class="hljs-attr">x-model</span>=<span class="hljs-string">&quot;form.name&quot;</span>
        @<span class="hljs-attr">change</span>=<span class="hljs-string">&quot;form.validate(&#x27;name&#x27;)&quot;</span>
    /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">x-if</span>=<span class="hljs-string">&quot;form.invalid(&#x27;name&#x27;)&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">x-text</span>=<span class="hljs-string">&quot;form.errors.name&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;email&quot;</span>&gt;</span>Email<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;email&quot;</span>
        <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;email&quot;</span>
        <span class="hljs-attr">x-model</span>=<span class="hljs-string">&quot;form.email&quot;</span>
        @<span class="hljs-attr">change</span>=<span class="hljs-string">&quot;form.validate(&#x27;email&#x27;)&quot;</span>
    /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">x-if</span>=<span class="hljs-string">&quot;form.invalid(&#x27;email&#x27;)&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">x-text</span>=<span class="hljs-string">&quot;form.errors.email&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">:disabled</span>=<span class="hljs-string">&quot;form.processing&quot;</span>&gt;</span>
        Create User
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
</code></pre><p>Now, as the form is filled by the user, Precognition will provide live validation output powered by the validation rules in the route&#39;s form request. When the form&#39;s inputs are changed, a debounced &quot;precognitive&quot; validation request will be sent to your Laravel application. You may configure the debounce timeout by calling the form&#39;s <code>setValidationTimeout</code> function:</p>
<pre><code class="hljs language-js">form.<span class="hljs-title function_">setValidationTimeout</span>(<span class="hljs-number">3000</span>);
</code></pre><p>When a validation request is in-flight, the form&#39;s <code>validating</code> property will be <code>true</code>:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">x-if</span>=<span class="hljs-string">&quot;form.validating&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Validating...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre><p>Any validation errors returned during a validation request or a form submission will automatically populate the form&#39;s <code>errors</code> object:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">x-if</span>=<span class="hljs-string">&quot;form.invalid(&#x27;email&#x27;)&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">x-text</span>=<span class="hljs-string">&quot;form.errors.email&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre><p>You can determine if the form has any errors using the form&#39;s <code>hasErrors</code> property:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">x-if</span>=<span class="hljs-string">&quot;form.hasErrors&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-comment">&lt;!-- ... --&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre><p>You may also determine if an input has passed or failed validation by passing the input&#39;s name to the form&#39;s <code>valid</code> and <code>invalid</code> functions, respectively:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">x-if</span>=<span class="hljs-string">&quot;form.valid(&#x27;email&#x27;)&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>✅<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">x-if</span>=<span class="hljs-string">&quot;form.invalid(&#x27;email&#x27;)&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>❌<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre><blockquote>
<p><strong>Warning</strong>
A form input will only appear as valid or invalid once it has changed and a validation response has been received.</p>
</blockquote>
<p>You may determine if a form submission request is in-flight by inspecting the form&#39;s <code>processing</code> property:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">:disabled</span>=<span class="hljs-string">&quot;form.processing&quot;</span>&gt;</span>
    Submit
<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
</code></pre><p><a name="repopulating-old-form-data"></a></p>
<h4>Repopulating Old Form Data</h4>
<p>In the user creation example discussed above, we are using Precognition to perform live validation; however, we are performing a traditional server-side form submission to submit the form. So, the form should be populated with any &quot;old&quot; input and validation errors returned from the server-side form submission:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">x-data</span>=<span class="hljs-string">&quot;{
    form: $form(&#x27;post&#x27;, &#x27;/register&#x27;, {
        name: &#x27;{{ old(&#x27;name&#x27;) }}&#x27;,
        email: &#x27;{{ old(&#x27;email&#x27;) }}&#x27;,
    }).setErrors({{ Js::from($errors-&gt;messages()) }}),
}&quot;</span>&gt;</span>
</code></pre><p>Alternatively, if you would like to submit the form via XHR you may use the form&#39;s <code>submit</code> function, which returns an Axios request promise:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> 
    <span class="hljs-attr">x-data</span>=<span class="hljs-string">&quot;{
        form: $form(&#x27;post&#x27;, &#x27;/register&#x27;, {
            name: &#x27;&#x27;,
            email: &#x27;&#x27;,
        }),
        submit() {
            this.form.submit()
                .then(response =&gt; {
                    form.reset();

                    alert(&#x27;User created.&#x27;)
                })
                .catch(error =&gt; {
                    alert(&#x27;An error occurred.&#x27;);
                });
        },
    }&quot;</span>
    @<span class="hljs-attr">submit.prevent</span>=<span class="hljs-string">&quot;submit&quot;</span>
&gt;</span>
</code></pre><p><a name="configuring-axios"></a></p>
<h3>Configuring Axios</h3>
<p>The Precognition validation libraries use the <a href="https://github.com/axios/axios">Axios</a> HTTP client to send requests to your application&#39;s backend. For convenience, the Axios instance may be customized if required by your application. For example, when using the <code>laravel-precognition-vue</code> library, you may add additional request headers to each outgoing request in your application&#39;s <code>resources/js/app.js</code> file:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> { client } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;laravel-precognition-vue&#x27;</span>;

client.<span class="hljs-title function_">axios</span>().<span class="hljs-property">defaults</span>.<span class="hljs-property">headers</span>.<span class="hljs-property">common</span>[<span class="hljs-string">&#x27;Authorization&#x27;</span>] = authToken;
</code></pre><p>Or, if you already have a configured Axios instance for your application, you may tell Precognition to use that instance instead:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Axios</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span>;
<span class="hljs-keyword">import</span> { client } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;laravel-precognition-vue&#x27;</span>;

<span class="hljs-variable language_">window</span>.<span class="hljs-property">axios</span> = <span class="hljs-title class_">Axios</span>.<span class="hljs-title function_">create</span>()
<span class="hljs-variable language_">window</span>.<span class="hljs-property">axios</span>.<span class="hljs-property">defaults</span>.<span class="hljs-property">headers</span>.<span class="hljs-property">common</span>[<span class="hljs-string">&#x27;Authorization&#x27;</span>] = authToken;

client.<span class="hljs-title function_">use</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">axios</span>)
</code></pre><blockquote>
<p><strong>Warning</strong>
The Inertia flavored Precognition libraries will only use the configured Axios instance for validation requests. Form submissions will always be sent by Inertia.</p>
</blockquote>
<p><a name="customizing-validation-rules"></a></p>
<h2>Customizing Validation Rules</h2>
<p>It is possible to customize the validation rules executed during a precognitive request by using the request&#39;s <code>isPrecognitive</code> method.</p>
<p>For example, on a user creation form, we may want to validate that a password is &quot;uncompromised&quot; only on the final form submission. For precognitive validation requests, we will simply validate that the password is required and has a minimum of 8 characters. Using the <code>isPrecognitive</code> method, we can customize the rules defined by our form request:</p>
<pre><code class="hljs language-php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-keyword">namespace</span> <span class="hljs-title class_">App</span>\<span class="hljs-title class_">Http</span>\<span class="hljs-title class_">Requests</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Foundation</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">FormRequest</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Validation</span>\<span class="hljs-title">Rules</span>\<span class="hljs-title">Password</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StoreUserRequest</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">FormRequest</span>
</span>{
    <span class="hljs-comment">/**
     * Get the validation rules that apply to the request.
     *
     * <span class="hljs-doctag">@return</span> array
     */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rules</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">return</span> [
            <span class="hljs-string">&#x27;password&#x27;</span> =&gt; [
                <span class="hljs-string">&#x27;required&#x27;</span>,
                <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">isPrecognitive</span>()
                    ? <span class="hljs-title class_">Password</span>::<span class="hljs-title function_ invoke__">min</span>(<span class="hljs-number">8</span>)
                    : <span class="hljs-title class_">Password</span>::<span class="hljs-title function_ invoke__">min</span>(<span class="hljs-number">8</span>)-&gt;<span class="hljs-title function_ invoke__">uncompromised</span>(),
            ],
            <span class="hljs-comment">// ...</span>
        ];
    }
}
</code></pre><p><a name="handling-file-uploads"></a></p>
<h2>Handling File Uploads</h2>
<p>By default, Laravel Precognition does not upload or validate files during a precognitive validation request. This ensure that large files are not unnecessarily uploaded multiple times.</p>
<p>Because of this behavior, you should ensure that your application <a href="#customizing-validation-rules">customizes the corresponding form request&#39;s validation rules</a> to specify the field is only required for full form submissions:</p>
<pre><code class="hljs language-php"><span class="hljs-comment">/**
 * Get the validation rules that apply to the request.
 *
 * <span class="hljs-doctag">@return</span> array
 */</span>
<span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rules</span>(<span class="hljs-params"></span>)
</span>{
    <span class="hljs-keyword">return</span> [
        <span class="hljs-string">&#x27;avatar&#x27;</span> =&gt; [
            ...<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">isPrecognitive</span>() ? [] : [<span class="hljs-string">&#x27;required&#x27;</span>],
            <span class="hljs-string">&#x27;image&#x27;</span>,
            <span class="hljs-string">&#x27;mimes:jpg,png&#x27;</span>
            <span class="hljs-string">&#x27;dimensions:ratio=3/2&#x27;</span>,
        ],
        <span class="hljs-comment">// ...</span>
    ];
}
</code></pre><p>If you would like to include files in every validation request, you may invoke the <code>validateFiles</code> function on your client-side form instance:</p>
<pre><code class="hljs language-js">form.<span class="hljs-title function_">validateFiles</span>();
</code></pre><p><a name="managing-side-effects"></a></p>
<h2>Managing Side-Effects</h2>
<p>When adding the <code>HandlePrecognitiveRequests</code> middleware to a route, you should consider if there are any side-effects in <em>other</em> middleware that should be skipped during a precognitive request.</p>
<p>For example, you may have a middleware that increments the total number of &quot;interactions&quot; each user has with your application, but you may not want precognitive requests to be counted as an interaction. To accomplish this, we may check the request&#39;s <code>isPrecognitive</code> method before incrementing the interaction count:</p>
<pre><code class="hljs language-php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-keyword">namespace</span> <span class="hljs-title class_">App</span>\<span class="hljs-title class_">Http</span>\<span class="hljs-title class_">Middleware</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Facades</span>\<span class="hljs-title">Interaction</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Closure</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Request</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InteractionMiddleware</span>
</span>{
    <span class="hljs-comment">/**
     * Handle an incoming request.
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle</span>(<span class="hljs-params">Request <span class="hljs-variable">$request</span>, <span class="hljs-built_in">Closure</span> <span class="hljs-variable">$next</span></span>): <span class="hljs-title">mixed</span>
    </span>{
        <span class="hljs-keyword">if</span> (! <span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">isPrecognitive</span>()) {
            <span class="hljs-title class_">Interaction</span>::<span class="hljs-title function_ invoke__">incrementFor</span>(<span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">user</span>());
        }

        <span class="hljs-keyword">return</span> <span class="hljs-variable">$next</span>(<span class="hljs-variable">$request</span>);
    }
}
</code></pre><p><a name="testing"></a></p>
<h2>Testing</h2>
<p>If you would like to make precognitive requests in your tests, Laravel&#39;s <code>TestCase</code> includes a <code>withPrecognition</code> helper which will add the <code>Precognition</code> request header.</p>
<p>Additionally, if you would like to assert that a precognitive request was successful, e.g., did not return any validation errors, you may use the <code>assertSuccessfulPrecognition</code> method on the response:</p>
<pre><code class="hljs language-php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test_it_validates_registration_form_with_precognition</span>(<span class="hljs-params"></span>)
</span>{
    <span class="hljs-variable">$response</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">withPrecognition</span>()
        -&gt;<span class="hljs-title function_ invoke__">post</span>(<span class="hljs-string">&#x27;/register&#x27;</span>, [
            <span class="hljs-string">&#x27;name&#x27;</span> =&gt; <span class="hljs-string">&#x27;Taylor Otwell&#x27;</span>,
        ]);

    <span class="hljs-variable">$response</span>-&gt;<span class="hljs-title function_ invoke__">assertSuccessfulPrecognition</span>();
    <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">assertSame</span>(<span class="hljs-number">0</span>, <span class="hljs-title class_">User</span>::<span class="hljs-title function_ invoke__">count</span>());
}
</code></pre>